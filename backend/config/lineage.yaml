---
# Lineage configuration

emitters:
  - module: openlineage.client

# ============================
# Validation
# ============================

validation:
  ci_checks:
    - name: schemas_exist
      type: path_exists
      paths:
        - schemas/market/tick.avsc
        - schemas/portfolio/positions.avsc

    - name: ids_unique
      type: unique_ids
      scope:
        - catalog.datasets
        - jobs

    - name: referenced_ids_exist
      type: xref
      rules:
        - name: job_inputs_exist
          source:
            collection: jobs
            field: inputs
          target:
            collection: catalog.datasets
            field: id

        - name: job_outputs_exist
          source:
            collection: jobs
            field: outputs
          target:
            collection: catalog.datasets
            field: id

# ============================
# Telemetry
# ============================

telemetry:
  siem_index_prefix: lineage
  emit_metrics: true
  metrics_namespace: lineage
  dimensions:
    - job_id
    - status
    - duration_ms
  exporters:
    - type: prometheus
      port: 9090
    - type: logging
      log_level: INFO 